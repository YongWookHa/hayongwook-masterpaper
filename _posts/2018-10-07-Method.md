# Method 
## 3.1. 개요
본 논문에서 제안하는 영상 생성 방법에 대한 흐름은 그림 3.1과 같이 나타낼 수 있다.
![image](https://user-images.githubusercontent.com/12293076/47953227-29087300-dfbe-11e8-8cc4-bc2f4121b1a1.png)
<br/> _그림 3.1 제안하는 영상 생성 방법 흐름도_

먼저 가우시안 분포를 따르는 잠재변수를 생성하여 변분 자동인코더의 입력으로 사용한다. 계층Ⅰ의 변분 자동인코더에서 생성된 저해상도 영상은 계층Ⅱ의 VDSR 초해상도 복원 모델에 의해 고해상도 영상으로 만들어진다. 

## 3.2. 변분 자동 인코더
변분 자동인코더(VAE: Variational Auto-Encoder)[1]는 기존의 자동인코더에서 잠재변수 의 분포를 고려하는 방법이다. 본 논문에서는 잠재변수가 가우시안 분포를 따르도록 설계하였다. 그림 3.1은 VAE의 구조이다.

![image](https://user-images.githubusercontent.com/12293076/47965676-32144580-e08d-11e8-8af4-897c012c4001.png)
<br/> _그림 3.2 VAE의 구조_

VAE의 인코더와 디코더는 각각 컨벌루션 계층과 상승 컨벌루션 계층으로 이루어져있다. 컨벌루션 계층을 통해 고차원 입력 데이터로부터 특징을 추출하여 저차원 잠재변수로 압축하고 상승 컨벌루션 계층을 통해 압축된 저차원 잠재변수로부터 고차원의 이미지를 생성한다. 인코더와 디코더가 동시에 학습을 진행하게 되며 생성 모델로 활용할 때에는 가우시안 분포를 따르는 잠재변수를 무작위로 생성하여 디코더를 통해 새로운 이미지를 생성한다.

### 3.2.1. 컨벌루셔널 뉴럴 네트워크
컨벌루셔널 뉴럴 네트워크(CNN: Convolutional Neural Network)[12]는 인간의 시신경과 뉴런의 구조를 모방하여 설계된 인공 신경망 구조이다. 컨벌루션은 주어진 목적에 따라 상응하는 커널(Kernel)을 선택하여 곱 연산을 수행하는 것을 의미한다. CNN은 컨벌루션(Convolution) 계층을 통해 데이터로부터 효과적으로 특징을 추출한다. 수식 3.1은 컨벌루션 연산을 나타낸다.

![image](https://user-images.githubusercontent.com/12293076/47965688-52440480-e08d-11e8-94cc-6dfb3b729751.png)

주어진 데이터 X에 하나 이상의 커널을 적용하여 추출한 특징들의 집합을 특징 맵(Feature map)이라고 한다. 기존의 컨벌루션 연산은 주로 영상 처리 분야에서 영상의 sharpen, blur 효과를 주거나 edge 검출 등의 목적에 자주 사용되던 연산이다. 기계학습에서는 컨벌루션 연산을 통해 형성된 특징 맵은 그 성능에 큰 영향을 미치기 때문에 특징 맵을 형성하는 다양한 방법론이 연구되었다.[13][14][15]

CNN에서는 기계학습에서 입력 데이터의 전처리 과정으로서 특징 맵 검출의 중요도를 매우 강조한다. 따라서 최적의 특징 맵을 생성할 수 있는 컨벌루션 커널을 학습하는 모델을 설계하는 것을 목표로 한다. 이것을 위해서 CNN은 컨벌루션 계층을 통해 특징 맵의 차원을 늘리고, 풀링(Pooling) 계층을 통해 학습을 조절하고 차원을 감축하며 활성화 함수(Activation Function)을 통해 계층 별로 전달되는 학습 값을 조절하는 방식으로 구성된다. 그림 3.3은 CNN의 구조이다.

![image](https://user-images.githubusercontent.com/12293076/47965692-612ab700-e08d-11e8-9717-1a977321d96e.png)
<br/> _그림 3.3 CNN의 구조_

CNN은 입력 데이터의 특징에 따라 사용하는 풀링 계층과 활성화 함수의 종류가 달라진다. 표 3.1과 표 3.2는 풀링 계층과 활성화 함수의 종류를 정리한다.

![image](https://user-images.githubusercontent.com/12293076/47965704-80c1df80-e08d-11e8-957c-535c630ce47b.png)

![image](https://user-images.githubusercontent.com/12293076/47966565-3e9d9b80-e097-11e8-9023-3d5c806bdbc2.png)


### 3.2.2. 상승 컨벌루셔널 뉴럴 네트워크

상승 컨벌루셔널 뉴럴 네트워크(Up Convolutional Neural Network)[16]는 컨벌루션 연산이 특징을 추출하는 과정에서 착안하여 설계된 저차원의 특징 맵으로부터 고차원의 특징 맵을 생성하는 신경망 구조이다. 학습 과정은 컨벌루셔널 뉴럴 네트워크와 같으나 kernel의 크기와 보폭(stride), 패딩(padding)의 설정값에 따라 생성되는 데이터의 크기를 임의로 정할 수 있다. 그림 3.4은 상승 컨벌루션 연산의 예시이다.

![image](https://user-images.githubusercontent.com/12293076/47965715-9f27db00-e08d-11e8-9313-bdd8417cf05e.png)
<br/> _그림 3.4 상승 컨벌루션 연산의 예시_

### 3.2.3. 인코더 구조 상세 설계
인코더는 여러개의 컨벌루션 계층을 사용하여 고차원 데이터의 특징을 추출해 저차원의 잠재변수로 압축하는 작업을 담당한다. 본 논문이 제안하는 모델의 인코더는 총 5개의 컨벌루션 계층과 1개의 완전 연결 계층으로 이루어져있다. 각 컨벌루션 계층과 완전 연결계층에는 Leaky ReLU 활성화 함수와 배치 정규화(Batch Normalization) 계층을 추가하여 학습 속도를 높이고 과적합(Overfitting) 현상을 줄였다. 인코더를 통해 생성할 잠재변수의 크기는 512로 정하였으며 각 컨벌루션 연산에 사용되는 커널(Kernel)의 크기는 5x5, 보폭(Stride)은 2로 설정하였다. 컨벌루션 계층을 거치면서 특징 맵의 개수가 2배씩 커짐에 따라 특징 맵의 개수는 32개부터 시작하여 컨벌루션 계층을 거치며 최종 출력 결과가 512 차원의 잠재변수가 되도록 하였다. 그림 3.5는 계층
